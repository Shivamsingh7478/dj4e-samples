{% extends 'base_bootstrap.html' %}

{% block content %}
<h1>{% if form.instance.pk %}Edit Ad{% else %}Create Ad{% endif %}</h1>

<form method="post" enctype="multipart/form-data" id="upload_form">
    {% csrf_token %}
    {{ form.as_p }}
    <input type="submit" value="Submit">
</form>

<script>
    // Check file size before form submission
    document.getElementById("upload_form").onsubmit = function(e) {
        var fileInput = document.querySelector('input[name="picture"]');
        if (fileInput && fileInput.files.length > 0) {
            var file = fileInput.files[0];
            var maxSize = 2 * 1024 * 1024; // 2MB
            if (file.size > maxSize) {
                alert("File size must be less than 2MB");
                e.preventDefault();
                return false;
            }
        }
        return true;
    };

    // Check file size when file is selected
    document.addEventListener('DOMContentLoaded', function() {
        var fileInput = document.querySelector('input[name="picture"]');
        if (fileInput) {
            fileInput.addEventListener('change', function() {
                if (this.files.length > 0) {
                    var file = this.files[0];
                    var maxSize = 2 * 1024 * 1024; // 2MB
                    if (file.size > maxSize) {
                        alert("File size must be less than 2MB");
                        this.value = '';
                    }
                }
            });
        }
    });
</script>
{% endblock %}
